<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.springboot.mapper.MenuMapper">
    <select id="getMenuTree" parameterType="MenuEo" resultType="MenuEo">
		select rid,rid id,url reqUrl,pid,code,name,ord,type,create_user createUser,status  from sys_menu
		where 1=1
		<if test="id !=null and id != ''">
			and pid = #{id}
		</if>
		<if test="type !=null and type != ''">
			and type = #{type}
		</if>
		<if test="queryFlag !=null and queryFlag != ''">
			and type != 'BUSI_TYPE'
		</if>
		order by ord
	</select>
	<insert id="saveMenuInfo" useGeneratedKeys="true" keyProperty="rid" parameterType="MenuEo">
		insert into sys_menu(
			url,pid,code,name,ord,type,create_time,create_user,status
		)
		values(#{reqUrl},#{pid},#{code},#{name},#{ord},#{type},(select now() from dual),#{createUser},#{status})
	</insert>

	<update id="updateMenuInfo" parameterType="MenuEo">
		update sys_menu set
			url = #{reqUrl},pid = #{pid},code = #{code},name = #{name},ord = #{ord},
			type = #{type},update_time = (select now() from dual),update_user = #{createUser},status = #{status}
		where rid = #{id}
	</update>

	<update id="del" parameterType="MenuEo">
		delete from sys_menu where rid = #{id}
	</update>
</mapper> 